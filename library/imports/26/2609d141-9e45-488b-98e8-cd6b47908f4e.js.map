{"version":3,"sources":["assets/game_writer/writer/writer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\nlet _vec3 = cc.v3();\nlet _domCount = 0;\nconst LEFT_PADDING = -5;\nconst BOTTOM_PADDING = -20;\ninterface MISTAKE_STROKEDATA {\n\tstrokeNum: number; // 这是汉字中的第几笔\n\tmistakesOnStroke: number; // 这一笔画错了多少次\n\ttotalMistakes: number; // 前面几笔一共画错了多少次\n\tstrokesRemaining: number; // 此字符中剩余的笔划数\n\tdrawnPath: object; // 包含pathString用户绘制的对象以及points用于评分的对象\n}\ninterface COMPLETE_STROKEDATA {\n\tcharacter: string; // 画对的字符是什么\n\ttotalMistakes: number; // 一共画错了多少笔\n}\n@ccclass\nexport default class Writer extends cc.Component {\n\tpublic writer = null;\n\tprivate _label: string = '';\n\n\t@property()\n\t_showOutline: boolean = false;\n\n\t@property({\n\t\ttooltip: '初始的颜色,即轮廓的颜色'\n\t})\n\toutlineColor: cc.Color = cc.color(221, 221, 221);\n\n\t@property({\n\t\ttooltip: '填充的颜色'\n\t})\n\tstrokeColor: cc.Color = cc.color(239, 42, 42);\n\n\t@property({\n\t\ttooltip: '提示下一笔时，高亮的颜色'\n\t})\n\thighlightColor: cc.Color = cc.color(22, 143, 22);\n\t@property({\n\t\ttooltip: '画图时笔迹的颜色'\n\t})\n\tdrawingColor: cc.Color = cc.color(32, 215, 102);\n\t@property({\n\t\ttooltip: '显示部首时，高亮的颜色'\n\t})\n\tradicalColor: cc.Color = cc.color(32, 215, 197);\n\n\t@property({\n\t\ttooltip: '在自动填充时，增大此数字可以更快地绘制笔划，减小此速度可以更慢地绘制笔划'\n\t})\n\tstrokeAnimationSpeed = 1;\n\t@property({\n\t\ttooltip: '在自动填充时，增大此数字可以更快地突出显示，降低该速度可以突出显示较慢'\n\t})\n\tstrokeHighlightSpeed = 2;\n\n\t@property({\n\t\ttooltip: '设置动画时每个笔画之间的时间（以毫秒为单位）'\n\t})\n\tdelayBetweenStrokes = 1000;\n\n\t@property({\n\t\ttooltip: '每个动画循环之间的时间（以毫秒为单位）'\n\t})\n\tdelayBetweenLoops = 2000;\n\n\t@property({\n\t\ttooltip: '错误几次自动提示下一笔'\n\t})\n\tshowHintAfterMisses = 1;\n\n\t@property({\n\t\ttooltip: '画图时笔迹的粗细'\n\t})\n\tdrawingWidth = 20;\n\n\t@property({\n\t\ttooltip: '控制当用户完成绘制整个汉字时测验是否短暂高亮显示汉字'\n\t})\n\thighlightOnComplete = true;\n\n\t@property({\n\t\ttype: cc.Component.EventHandler,\n\t\tdisplayName: 'onComplete',\n\t\ttooltip: '完成一个字时触发'\n\t})\n\tonComplete = new cc.Component.EventHandler();\n\n\t@property({\n\t\ttype: cc.Component.EventHandler,\n\t\tdisplayName: 'onCorrectStroke',\n\t\ttooltip: '画对一笔时触发'\n\t})\n\tonCorrectStroke = new cc.Component.EventHandler();\n\n\t@property({\n\t\ttype: cc.Component.EventHandler,\n\t\tdisplayName: 'onMistake',\n\t\ttooltip: '当画错时触发'\n\t})\n\tonMistake = new cc.Component.EventHandler();\n\n\tpublic set writerActive(newVal) {\n\t\tif (this._writerActive == newVal) return;\n\t\tthis._writerActive = newVal;\n\t\tthis._updateActive();\n\t}\n\n\tpublic get writerActive() {\n\t\treturn this._writerActive;\n\t}\n\tprivate _writerActive = false;\n\tprivate _padding = 20; // 绘画区域的外扩面积\n\tprivate _worldMat: cc.Mat4 = null;\n\tprivate _m00 = 0;\n\tprivate _m01 = 0;\n\tprivate _m04 = 0;\n\tprivate _m05 = 0;\n\tprivate _m12 = 0;\n\tprivate _m13 = 0;\n\tprivate _w = 0;\n\tprivate _h = 0;\n\tprivate _scaleX = 1;\n\tprivate _scaleY = 0;\n\tprivate _labelWidth = 0;\n\tprivate _labelHeight = 0;\n\tprivate _cacheViewportRect: cc.Rect = null;\n\tprivate _elem: HTMLElement = null;\n\tprivate _domId = '';\n\tprivate _hasInit = false;\n\tprivate _eventListeners: any = {};\n\n\t_init() {\n\t\tthis._label = this.node.getComponent(cc.Label).string;\n\t\tthis._labelWidth = this.node.width;\n\t\tthis._labelHeight = this.node.height;\n\t\tthis._domId = `WriteBox${++_domCount}`;\n\t\tthis._elem = null;\n\t\tthis._worldMat = new cc.Mat4();\n\t\tthis._cameraMat = new cc.Mat4();\n\t\tthis._m00 = 0;\n\t\tthis._m01 = 0;\n\t\tthis._m04 = 0;\n\t\tthis._m05 = 0;\n\t\tthis._m12 = 0;\n\t\tthis._m13 = 0;\n\t\tthis._w = 0;\n\t\tthis._h = 0;\n\t\tthis._cacheViewportRect = cc.rect(0, 0, 0, 0);\n\t\tthis.initHanzi();\n\t\tthis.node.getComponent(cc.Label).enabled = false;\n\t\tthis._hasInit = true;\n\t}\n\tprivate _createDom() {\n\t\tthis._elem = document.createElement('div');\n\t}\n\tprivate _initStyleSheet() {\n\t\tlet elem = this._elem;\n\t\t// elem.style.display = 'none';\n\t\telem.style.border = '0';\n\t\telem.style.background = 'transparent';\n\t\telem.style.width = '100%';\n\t\telem.style.height = '100%';\n\t\telem.style.padding = '0';\n\t\telem.style.position = 'absolute';\n\t\telem.style.bottom = BOTTOM_PADDING + 'px';\n\t\telem.style.left = LEFT_PADDING + 'px';\n\t\telem.id = this._domId;\n\t}\n\tprivate _addDomToGameContainer() {\n\t\tcc.game.container.appendChild(this._elem);\n\t}\n\n\tprivate _cameraMat: cc.Mat4 = null;\n\tprivate _updateMatrix() {\n        let node = this.node;\n        cc.log(this._worldMat)\n\t\tnode.getWorldMatrix(this._worldMat);\n\t\tlet worldMat = this._worldMat;\n\t\tlet worldMatm = worldMat.m;\n\t\tlet localView = cc.view;\n\t\t// 检测是否需要挪动位置\n\t\tif (\n\t\t\tthis._m00 === worldMatm[0] &&\n\t\t\tthis._m01 === worldMatm[1] &&\n\t\t\tthis._m04 === worldMatm[4] &&\n\t\t\tthis._m05 === worldMatm[5] &&\n\t\t\tthis._m12 === worldMatm[12] &&\n\t\t\tthis._m13 === worldMatm[13] &&\n\t\t\tthis._w === node.getContentSize().width &&\n\t\t\tthis._h === node.getContentSize().height &&\n\t\t\tthis._cacheViewportRect.equals(localView.getViewportRect())\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// 更新矩阵缓存\n\t\tthis._m00 = worldMatm[0];\n\t\tthis._m01 = worldMatm[1];\n\t\tthis._m04 = worldMatm[4];\n\t\tthis._m05 = worldMatm[5];\n\t\tthis._m12 = worldMatm[12];\n\t\tthis._m13 = worldMatm[13];\n\t\tthis._w = node.getContentSize().width;\n\t\tthis._h = node.getContentSize().height;\n\n\t\t// 更新视图缓存 需要判断缩放和锚点\n\t\tthis._cacheViewportRect.set(localView.getViewportRect());\n\t\t// @ts-ignore\n\t\tlet scaleX = localView._scaleX;\n\t\t// @ts-ignore\n\t\tlet scaleY = localView._scaleY;\n\t\t// @ts-ignore\n\t\tlet viewport = localView._viewportRect;\n\t\t// @ts-ignore\n\t\tlet dpr = localView._devicePixelRatio;\n\t\t// @ts-ignore\n\t\t_vec3.x = -node._anchorPoint.x * this._w;\n\t\t// @ts-ignore\n\t\t_vec3.y = -node._anchorPoint.y * this._h;\n\n\t\tcc.Mat4.transform(worldMat, worldMat, _vec3);\n\n\t\tlet cameraMat;\n\n\t\tlet camera = cc.Camera.findCamera(node);\n\t\tcamera.getWorldToScreenMatrix2D(this._cameraMat);\n\t\tcameraMat = this._cameraMat;\n\t\t// @ts-ignore\n\t\tcc.Mat4.mul(cameraMat, cameraMat, worldMat);\n\n\t\tscaleX /= dpr;\n\t\tscaleY /= dpr;\n\n\t\tlet container = cc.game.container;\n\t\tlet cameraMatm = cameraMat.m;\n\t\tlet a = cameraMatm[0] * scaleX,\n\t\t\tb = cameraMatm[1],\n\t\t\tc = cameraMatm[4],\n\t\t\td = cameraMatm[5] * scaleY;\n\t\tthis._scaleX = a;\n\t\tthis._scaleY = d;\n\t\tlet offsetX =\n\t\t\tcontainer && container.style.paddingLeft && parseInt(container.style.paddingLeft);\n\t\toffsetX += viewport.x / dpr;\n\t\tlet offsetY =\n\t\t\tcontainer && container.style.paddingBottom && parseInt(container.style.paddingBottom);\n\t\toffsetY += viewport.y / dpr;\n\t\tlet tx = cameraMatm[12] * scaleX + offsetX,\n\t\t\tty = cameraMatm[13] * scaleY + offsetY;\n\n\t\tlet elem = this._elem;\n\t\tlet matrix = 'matrix(' + 1 + ',' + -b + ',' + -c + ',' + 1 + ',' + tx + ',' + -ty + ')';\n\t\telem.style['transform'] = matrix;\n\t\telem.style['-webkit-transform'] = matrix;\n\t\telem.style['transform-origin'] = '0px 100% 0px';\n\t\telem.style['-webkit-transform-origin'] = '0px 100% 0px';\n\t}\n\n\tprivate _updateHanzi() {\n\t\tthis._labelWidth = this.node.width;\n\t\tthis._labelHeight = this.node.height;\n\t\tthis.destroySelf();\n\t\tthis.initHanzi();\n\t}\n\tprivate _updateActive() {\n\t\tif (this._writerActive) {\n\t\t\tif (!this._hasInit) {\n\t\t\t\tthis._init();\n\t\t\t} else {\n\t\t\t\tthis._showDom();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._hideDom();\n\t\t}\n\t}\n\n\tprivate _showDom() {\n\t\tthis._updateMatrix();\n\t\tthis._elem.style.display = '';\n\t}\n\n\tprivate _hideDom() {\n\t\tthis._elem.style.display = 'none';\n\t}\n\tprivate _clear() {\n\t\tif (document.getElementById(this._domId)) {\n\t\t\tdocument.getElementById(this._domId).remove();\n\t\t}\n\t}\n\tprivate _registerEventListeners() {\n\t\tlet impl = this;\n\t\tlet cbs = this._eventListeners;\n\n\t\tcbs.onResize = function() {\n\t\t\timpl._updateMatrix();\n\t\t};\n\t\tcbs.POSITION_CHANGED = function() {\n\t\t\timpl._updateMatrix();\n\t\t};\n\t\tcbs.SIZE_CHANGED = function() {\n\t\t\timpl._updateHanzi();\n\t\t};\n\t\tcbs.ANCHOR_CHANGED = function() {\n\t\t\timpl._updateMatrix();\n\t\t};\n\t\twindow.addEventListener('resize', cbs.onResize);\n\t\twindow.addEventListener('orientationchange', cbs.onResize);\n\n\t\tthis.node.on(cc.Node.EventType.POSITION_CHANGED, cbs.POSITION_CHANGED, this);\n\t\tthis.node.on(cc.Node.EventType.SIZE_CHANGED, cbs.SIZE_CHANGED, this);\n\t\tthis.node.on(cc.Node.EventType.ANCHOR_CHANGED, cbs.ANCHOR_CHANGED, this);\n\t}\n\tprivate _removeEventListeners() {\n\t\tlet cbs = this._eventListeners;\n\t\twindow.removeEventListener('resize', cbs.onResize);\n\t\twindow.removeEventListener('orientationchange', cbs.onResize);\n\t\tthis.node.off(cc.Node.EventType.POSITION_CHANGED, cbs.POSITION_CHANGED, this);\n\t\tthis.node.off(cc.Node.EventType.SIZE_CHANGED, cbs.SIZE_CHANGED, this);\n\t\tthis.node.off(cc.Node.EventType.ANCHOR_CHANGED, cbs.ANCHOR_CHANGED, this);\n\t}\n\n\tpublic initHanzi() {\n\t\tthis._createDom();\n\t\tthis._initStyleSheet();\n\t\tthis._updateMatrix();\n\t\tthis.setSize();\n\t\tthis._addDomToGameContainer();\n\t\tthis._registerEventListeners();\n\t\t// @ts-ignore\n\t\tthis.writer = HanziWriter.create(this._domId, this._label, {\n\t\t\twidth: (this._labelWidth + this._padding * 2) * this._scaleX,\n\t\t\theight: (this._labelHeight + this._padding * 2) * this._scaleY,\n\t\t\tpadding: this._padding * this._scaleX,\n\t\t\tshowHintAfterMisses: this.showHintAfterMisses,\n\t\t\tstrokeColor: '#' + this.strokeColor.toHEX('#rrggbb'),\n\t\t\thighlightColor: '#' + this.highlightColor.toHEX('#rrggbb'),\n\t\t\tradicalColor: '#' + this.radicalColor.toHEX('#rrggbb'),\n\t\t\toutlineColor: '#' + this.outlineColor.toHEX('#rrggbb'),\n\t\t\tdrawingColor: '#' + this.drawingColor.toHEX('#rrggbb'),\n\t\t\tdrawingWidth: this.drawingWidth,\n\t\t\tstrokeAnimationSpeed: this.strokeAnimationSpeed,\n\t\t\tdelayBetweenStrokes: this.delayBetweenStrokes,\n\t\t\thighlightOnComplete: this.highlightOnComplete,\n\t\t\tstrokeHighlightSpeed: this.strokeHighlightSpeed,\n\t\t\tdelayBetweenLoops: this.delayBetweenLoops\n\t\t});\n\t\tconst component = this;\n\t\tthis.writer.quiz({\n\t\t\tonComplete(summaryData: COMPLETE_STROKEDATA) {\n\t\t\t\tcc.log('complete');\n\t\t\t\tcc.Component.EventHandler.emitEvents(\n\t\t\t\t\t[component.onComplete],\n\t\t\t\t\tsummaryData,\n\t\t\t\t\tcomponent\n\t\t\t\t);\n\t\t\t},\n\t\t\tonCorrectStroke(strokeData: MISTAKE_STROKEDATA) {\n\t\t\t\tcc.log('当前的笔画编号:' + strokeData.strokeNum);\n\t\t\t\tcc.Component.EventHandler.emitEvents(\n\t\t\t\t\t[component.onCorrectStroke],\n\t\t\t\t\tstrokeData,\n\t\t\t\t\tcomponent\n\t\t\t\t);\n\t\t\t},\n\t\t\tonMistake(strokeData: MISTAKE_STROKEDATA) {\n\t\t\t\tcc.log('error');\n\t\t\t\tcc.Component.EventHandler.emitEvents([component.onMistake], strokeData, component);\n\t\t\t}\n\t\t});\n\t}\n\tpublic show() {\n\t\tthis._showDom();\n\t}\n\tpublic hide() {\n\t\tthis._hideDom();\n\t}\n\tpublic destroySelf() {\n\t\tthis._elem = null;\n\t\tthis._removeEventListeners();\n\t\tthis._clear();\n\t}\n\t// 改变cocos内的label之后调用这个方法\n\tpublic changeLabel() {\n\t\tthis._clear();\n\t\tthis._init();\n\t}\n\tpublic animateCharacter() {\n\t\tthis.writer.animateCharacter();\n\t}\n\tpublic setSize() {\n\t\tlet elem = this._elem;\n\t\telem.style.width = (this._labelWidth + this._padding * 2) * this._scaleX + 'px';\n\t\telem.style.height = (this._labelHeight + this._padding * 2) * this._scaleY + 'px';\n\t}\n\n\tonEnable() {\n\t\tthis._init();\n\t}\n\n\tonDisable() {\n\t\tthis.destroySelf();\n\t}\n}\n"]}